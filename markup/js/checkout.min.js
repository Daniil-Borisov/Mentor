const stripe=Stripe("pk_test_TYooMQauvdEDq54NiTphI7jx"),items=[{id:"xl-tshirt"}];let elements;async function initialize(){var e=(await fetch("/create.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:items})}).then(e=>e.json()))["clientSecret"];const t=(elements=stripe.elements({clientSecret:e})).create("payment");t.mount("#payment-element")}async function handleSubmit(e){e.preventDefault(),setLoading(!0);e=(await stripe.confirmPayment({elements:elements,confirmParams:{return_url:"http://localhost:4242/public/checkout.html"}})).error;"card_error"===e.type||"validation_error"===e.type?showMessage(e.message):showMessage("An unexpected error occurred."),setLoading(!1)}async function checkStatus(){var e=new URLSearchParams(window.location.search).get("payment_intent_client_secret");if(e){e=(await stripe.retrievePaymentIntent(e))["paymentIntent"];switch(e.status){case"succeeded":showMessage("Payment succeeded!");break;case"processing":showMessage("Your payment is processing.");break;case"requires_payment_method":showMessage("Your payment was not successful, please try again.");break;default:showMessage("Something went wrong.")}}}function showMessage(e){const t=document.querySelector("#payment-message");t.classList.remove("hidden"),t.textContent=e,setTimeout(function(){t.classList.add("hidden"),e.textContent=""},4e3)}function setLoading(e){e?(document.querySelector("#submit").disabled=!0,document.querySelector("#spinner").classList.remove("hidden"),document.querySelector("#button-text").classList.add("hidden")):(document.querySelector("#submit").disabled=!1,document.querySelector("#spinner").classList.add("hidden"),document.querySelector("#button-text").classList.remove("hidden"))}initialize(),checkStatus(),document.querySelector("#payment-form").addEventListener("submit",handleSubmit);